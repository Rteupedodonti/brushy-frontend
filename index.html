<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiÅŸ FÄ±rÃ§alama Takip</title>
    <script type="text/javascript" nonce="b635fea0a2bf4e60b846def1363" src="//local.adguard.org?ts=1761285055505&amp;type=content-script&amp;dmn=mgx.dev&amp;url=https%3A%2F%2Fmgx.dev%2Fapi%2Fv1%2Ffiles%2Fdownload%3Fpath%3D%252Fchats%252Fcdb8c0f7114c47c9859d204a340a434d%252F.storage%252F81%252F28e07ea2%252Findex.html&amp;app=opera.exe&amp;css=3&amp;js=1&amp;rel=1&amp;rji=1&amp;sbe=1"></script><script type="text/javascript" nonce="b635fea0a2bf4e60b846def1363" src="//local.adguard.org?ts=1761285055505&amp;name=AdGuard%20Extra&amp;name=AdGuard%20Popup%20Blocker&amp;type=user-script"></script><link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="DiÅŸ Takip">
    <link rel="apple-touch-icon" href="icon-192x192.png">
</head>
<body>
    <!-- Auth Screen (KayÄ±t/GiriÅŸ) -->
    <div id="auth-screen" class="screen active">
        <div class="auth-container">
            <div class="app-header">
                <div class="tooth-icon">ğŸ¦·</div>
                <h1>DiÅŸ FÄ±rÃ§alama Takip</h1>
                <p>Ã‡ocuklar iÃ§in eÄŸlenceli diÅŸ bakÄ±mÄ±</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="register">KayÄ±t Ol</button>
                <button class="auth-tab" data-tab="login">GiriÅŸ Yap</button>
            </div>

            <!-- KayÄ±t Formu -->
            <div id="register-form" class="auth-form active">
                <h2>Veli KaydÄ±</h2>
                <form id="parent-register-form">
                    <div class="form-group">
                        <label for="parent-name">Veli AdÄ± SoyadÄ±</label>
                        <input type="text" id="parent-name" required>
                    </div>
                    <div class="form-group">
                        <label for="parent-phone">Telefon NumarasÄ±</label>
                        <input type="tel" id="parent-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="parent-email">E-posta (Opsiyonel)</label>
                        <input type="email" id="parent-email">
                    </div>
                    
                    <button type="submit" class="btn-primary">KayÄ±t Ol</button>
                </form>
            </div>

            <!-- GiriÅŸ Formu -->
            <div id="login-form" class="auth-form">
                <h2>GiriÅŸ Yap</h2>
                <form id="parent-login-form">
                    <div class="form-group">
                        <label for="login-phone">Telefon NumarasÄ±</label>
                        <input type="tel" id="login-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="login-name">Veli AdÄ±</label>
                        <input type="text" id="login-name" required>
                    </div>
                    <button type="submit" class="btn-primary">GiriÅŸ Yap</button>
                </form>
            </div>

            <!-- Admin Access Button -->
            <div class="admin-access">
                <button class="admin-btn" onclick="showAdminLogin()">âš™ï¸ Admin</button>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="modal" style="display: none;">
        <div class="modal-content admin-modal">
            <h3>Admin GiriÅŸi</h3>
            <div class="form-group">
                <label for="admin-password">Admin Åifresi</label>
                <input type="password" id="admin-password" placeholder="Åifrenizi girin">
            </div>
            <div class="form-actions">
                <button type="button" onclick="hideAdminLogin()">Ä°ptal</button>
                <button type="button" onclick="verifyAdminAccess()" class="btn-primary">GiriÅŸ</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel Screen -->
    <div id="admin-panel-screen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="showScreen('auth-screen')">â†</button>
            <h1>Admin Paneli</h1>
            <button class="logout-btn" onclick="logoutAdmin()">Ã‡Ä±kÄ±ÅŸ</button>
        </div>

        <div class="admin-content">
            <!-- System Status -->
            <div class="admin-section">
                <h3>ğŸ”§ Sistem Durumu</h3>
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-icon">ğŸ‘¥</div>
                        <div class="status-info">
                            <div class="status-number" id="total-parents">0</div>
                            <div class="status-label">Toplam Veli</div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-icon">ğŸ‘¶</div>
                        <div class="status-info">
                            <div class="status-number" id="total-children">0</div>
                            <div class="status-label">Toplam Ã‡ocuk</div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-icon">ğŸ¦·</div>
                        <div class="status-info">
                            <div class="status-number" id="total-sessions">0</div>
                            <div class="status-label">Toplam FÄ±rÃ§alama</div>
                        </div>
                    </div>
                    <div class="status-card">
                        <div class="status-icon">ğŸ†</div>
                        <div class="status-info">
                            <div class="status-number" id="total-rewards">0</div>
                            <div class="status-label">KazanÄ±lan Rozet</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hybrid Storage Status -->
            <div class="admin-section">
                <h3>ğŸ”„ Hibrit Storage Durumu</h3>
                <div class="storage-status">
                    <div class="storage-item">
                        <div class="storage-icon">ğŸ’¾</div>
                        <div class="storage-info">
                            <div class="storage-title">Local Storage</div>
                            <div class="storage-desc">Ã‡evrimdÄ±ÅŸÄ± veri depolama</div>
                            <div class="storage-status-indicator local-storage">Aktif</div>
                        </div>
                    </div>
                    <div class="storage-item">
                        <div class="storage-icon">â˜ï¸</div>
                        <div class="storage-info">
                            <div class="storage-title">Backend Storage</div>
                            <div class="storage-desc">Ã‡evrimiÃ§i senkronizasyon</div>
                            <div class="storage-status-indicator" id="backend-storage-status">Test Edilmedi</div>
                        </div>
                    </div>
                    <div class="storage-item">
                        <div class="storage-icon">ğŸ”„</div>
                        <div class="storage-info">
                            <div class="storage-title">Sync Queue</div>
                            <div class="storage-desc">Bekleyen senkronizasyon</div>
                            <div class="storage-status-indicator" id="sync-queue-status">0 Ã¶ÄŸe</div>
                        </div>
                    </div>
                </div>
                <div class="storage-actions">
                    <button onclick="forceSyncAll()" class="btn-secondary">
                        <span>ğŸ”„</span>
                        TÃ¼mÃ¼nÃ¼ Senkronize Et
                    </button>
                    <button onclick="clearSyncQueue()" class="btn-secondary">
                        <span>ğŸ—‘ï¸</span>
                        Sync KuyruÄŸunu Temizle
                    </button>
                </div>
            </div>

            <!-- Backend Configuration -->
            <div class="admin-section">
                <h3>ğŸŒ Backend YapÄ±landÄ±rmasÄ±</h3>
                <div class="config-form">
                    <div class="form-group">
                        <label for="admin-backend-url">Backend URL</label>
                        <input type="url" id="admin-backend-url" placeholder="https://your-backend.onrender.com/api">
                        <small>Backend API'niz iÃ§in tam URL'yi girin</small>
                    </div>
                    <div class="form-group">
                        <label>BaÄŸlantÄ± Durumu</label>
                        <div class="connection-status">
                            <span id="admin-connection-status" class="status-offline">Test Edilmedi</span>
                            <button onclick="testAdminConnection()" class="btn-secondary">BaÄŸlantÄ±yÄ± Test Et</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Debug Settings -->
            <div class="admin-section">
                <h3>ğŸ› Debug AyarlarÄ±</h3>
                <div class="debug-settings">
                    <div class="setting-item">
                        <label class="switch">
                            <input type="checkbox" id="admin-debug-mode">
                            <span class="slider"></span>
                        </label>
                        <div class="setting-info">
                            <div class="setting-title">Debug Modu</div>
                            <div class="setting-desc">GiriÅŸ ekranÄ±nÄ± atla, test verileri oluÅŸtur</div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label class="switch">
                            <input type="checkbox" id="admin-console-logs">
                            <span class="slider"></span>
                        </label>
                        <div class="setting-info">
                            <div class="setting-title">Console LoglarÄ±</div>
                            <div class="setting-desc">DetaylÄ± sistem loglarÄ±nÄ± etkinleÅŸtir</div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label class="switch">
                            <input type="checkbox" id="admin-analytics">
                            <span class="slider"></span>
                        </label>
                        <div class="setting-info">
                            <div class="setting-title">Analytics</div>
                            <div class="setting-desc">KullanÄ±m istatistiklerini topla</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Management -->
            <div class="admin-section">
                <h3>ğŸ’¾ Veri YÃ¶netimi</h3>
                <div class="data-actions">
                    <button onclick="exportAllData()" class="btn-secondary">
                        <span>ğŸ“¤</span>
                        TÃ¼m Verileri DÄ±ÅŸa Aktar
                    </button>
                    <button onclick="importData()" class="btn-secondary">
                        <span>ğŸ“¥</span>
                        Veri Ä°Ã§e Aktar
                    </button>
                    <button onclick="clearAllData()" class="btn-danger">
                        <span>ğŸ—‘ï¸</span>
                        TÃ¼m Verileri Temizle
                    </button>
                </div>
            </div>

            <!-- System Logs -->
            <div class="admin-section">
                <h3>ğŸ“‹ Sistem LoglarÄ±</h3>
                <div class="logs-container">
                    <div class="logs-header">
                        <span>Son Aktiviteler</span>
                        <button onclick="clearLogs()" class="btn-small">Temizle</button>
                    </div>
                    <div id="admin-logs" class="logs-content">
                        <div class="log-entry">
                            <span class="log-time">2024-01-15 14:30:22</span>
                            <span class="log-level info">INFO</span>
                            <span class="log-message">Admin paneli aÃ§Ä±ldÄ±</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="admin-section">
                <h3>âš¡ HÄ±zlÄ± Ä°ÅŸlemler</h3>
                <div class="quick-actions">
                    <button onclick="generateTestData()" class="action-btn">
                        <span>ğŸ§ª</span>
                        <div>
                            <div class="action-title">Test Verisi OluÅŸtur</div>
                            <div class="action-desc">Ã–rnek veli ve Ã§ocuk verileri ekle</div>
                        </div>
                    </button>
                    <button onclick="resetAllStreaks()" class="action-btn">
                        <span>ğŸ”„</span>
                        <div>
                            <div class="action-title">Serileri SÄ±fÄ±rla</div>
                            <div class="action-desc">TÃ¼m Ã§ocuklarÄ±n serilerini sÄ±fÄ±rla</div>
                        </div>
                    </button>
                    <button onclick="recalculateRewards()" class="action-btn">
                        <span>ğŸ†</span>
                        <div>
                            <div class="action-title">Rozetleri Yeniden Hesapla</div>
                            <div class="action-desc">TÃ¼m rozetleri kontrol et ve gÃ¼ncelle</div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Save Button -->
            <div class="admin-actions">
                <button onclick="saveAdminSettings()" class="btn-primary btn-large">
                    ğŸ’¾ AyarlarÄ± Kaydet
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard-screen" class="screen">
        <div class="header">
            <div class="header-left">
                <h1>Merhaba, <span id="parent-name-display"></span>!</h1>
                <div class="sync-status">
                    <span id="sync-indicator" class="sync-offline">Ã‡evrimdÄ±ÅŸÄ±</span>
                </div>
            </div>
            <button class="profile-btn" onclick="showScreen('profile-screen')">ğŸ‘¤</button>
        </div>

        <div class="children-section">
            <div class="section-header">
                <h2>Ã‡ocuklar</h2>
                <button class="btn-secondary" onclick="showAddChildForm()">+ Ã‡ocuk Ekle</button>
            </div>
            <div id="children-list" class="children-grid"></div>
        </div>

        <!-- Add Child Form -->
        <div id="add-child-form" class="modal" style="display: none;">
            <div class="modal-content">
                <h3>Yeni Ã‡ocuk Ekle</h3>
                <form id="child-form">
                    <div class="form-group">
                        <label for="child-name">Ã‡ocuk AdÄ±</label>
                        <input type="text" id="child-name" required>
                    </div>
                    <div class="form-group">
                        <label for="child-age">YaÅŸ</label>
                        <input type="number" id="child-age" min="0" max="18" required>
                    </div>
                    <div class="form-group">
                        <label>Avatar SeÃ§</label>
                        <div class="avatar-grid" id="avatar-selection"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" onclick="hideAddChildForm()">Ä°ptal</button>
                        <button type="submit" class="btn-primary">Kaydet</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn active" onclick="showScreen('dashboard-screen')">
                <span>ğŸ </span>
                <span>Ana Sayfa</span>
            </button>
            <button class="nav-btn" onclick="showScreen('timer-screen')">
                <span>â°</span>
                <span>Timer</span>
            </button>
            <button class="nav-btn" onclick="showScreen('stats-screen')">
                <span>ğŸ“Š</span>
                <span>Ä°statistik</span>
            </button>
            <button class="nav-btn" onclick="showScreen('profile-screen')">
                <span>ğŸ‘¤</span>
                <span>Profil</span>
            </button>
        </div>
    </div>

    <!-- Child Detail Screen -->
    <div id="child-detail-screen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="showScreen('dashboard-screen')">â†</button>
            <h1 id="child-detail-name"></h1>
            <button class="edit-btn" onclick="editChild()">âœï¸</button>
        </div>

        <div class="child-profile">
            <div class="child-avatar-large" id="child-detail-avatar"></div>
            <div class="child-info">
                <h2 id="child-detail-name-display"></h2>
                <p id="child-detail-age"></p>
                <div class="streak-info">
                    <div class="streak-item">
                        <span class="streak-number" id="current-streak">0</span>
                        <span class="streak-label">GÃ¼ncel Seri</span>
                    </div>
                    <div class="streak-item">
                        <span class="streak-number" id="longest-streak">0</span>
                        <span class="streak-label">En Uzun Seri</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="quick-actions">
            <button class="action-btn morning" onclick="startTimer('morning')">
                <span>ğŸŒ…</span>
                <span>Sabah FÄ±rÃ§alama</span>
            </button>
            <button class="action-btn evening" onclick="startTimer('evening')">
                <span>ğŸŒ™</span>
                <span>AkÅŸam FÄ±rÃ§alama</span>
            </button>
        </div>

        <div class="rewards-section">
            <h3>Rozetler</h3>
            <div id="child-rewards" class="rewards-grid"></div>
        </div>

        <div class="recent-activity">
            <h3>Son Aktiviteler</h3>
            <div id="recent-brushing" class="activity-list"></div>
        </div>
    </div>

    <!-- Timer Screen -->
    <div id="timer-screen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="showScreen('dashboard-screen')">â†</button>
            <h1>DiÅŸ FÄ±rÃ§alama</h1>
            <div class="session-type" id="session-type-display">Sabah</div>
        </div>

        <div class="timer-container">
            <div class="timer-circle" id="timer-circle">
                <div class="timer-display">
                    <span id="timer-minutes">02</span>
                    <span class="timer-colon">:</span>
                    <span id="timer-seconds">00</span>
                </div>
                <div class="timer-progress" id="timer-progress"></div>
            </div>
            
            <div class="timer-controls">
                <button id="timer-btn" class="btn-primary" onclick="toggleTimer()">BaÅŸla</button>
            </div>

            <div class="brushing-tips" id="brushing-tips">
                <h3>FÄ±rÃ§alama Ä°pucu</h3>
                <p id="current-tip">DiÅŸlerini nazikÃ§e dairesel hareketlerle fÄ±rÃ§ala!</p>
            </div>

            <div class="timer-effects" id="timer-effects"></div>
        </div>
    </div>

    <!-- Stats Screen -->
    <div id="stats-screen" class="screen">
        <div class="header">
            <h1>Ä°statistikler</h1>
            <div class="stats-filter">
                <select id="stats-child-filter">
                    <option value="all">TÃ¼m Ã‡ocuklar</option>
                </select>
            </div>
        </div>

        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-number" id="total-brushings">0</div>
                <div class="stat-label">Toplam FÄ±rÃ§alama</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avg-duration">0</div>
                <div class="stat-label">Ortalama SÃ¼re</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="best-streak">0</div>
                <div class="stat-label">En Ä°yi Seri</div>
            </div>
        </div>

        <div class="stats-charts">
            <div class="chart-section">
                <h3>HaftalÄ±k Aktivite</h3>
                <div id="weekly-chart" class="chart"></div>
            </div>
            <div class="chart-section">
                <h3>GÃ¼nlÃ¼k DaÄŸÄ±lÄ±m</h3>
                <div id="daily-distribution" class="chart"></div>
            </div>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn" onclick="showScreen('dashboard-screen')">
                <span>ğŸ </span>
                <span>Ana Sayfa</span>
            </button>
            <button class="nav-btn" onclick="showScreen('timer-screen')">
                <span>â°</span>
                <span>Timer</span>
            </button>
            <button class="nav-btn active" onclick="showScreen('stats-screen')">
                <span>ğŸ“Š</span>
                <span>Ä°statistik</span>
            </button>
            <button class="nav-btn" onclick="showScreen('profile-screen')">
                <span>ğŸ‘¤</span>
                <span>Profil</span>
            </button>
        </div>
    </div>

    <!-- Profile Screen -->
    <div id="profile-screen" class="screen">
        <div class="header">
            <h1>Profil</h1>
        </div>

        <div class="profile-section">
            <h3>Veli Bilgileri</h3>
            <div class="profile-info">
                <div class="info-item">
                    <label>Ad Soyad:</label>
                    <span id="profile-parent-name"></span>
                </div>
                <div class="info-item">
                    <label>Telefon:</label>
                    <span id="profile-parent-phone"></span>
                </div>
                <div class="info-item">
                    <label>E-posta:</label>
                    <span id="profile-parent-email"></span>
                </div>
            </div>
        </div>

        <div class="profile-section">
            <h3>Uygulama AyarlarÄ±</h3>
            <div class="settings-list">
                <div class="setting-item">
                    <label>Bildirimler</label>
                    <input type="checkbox" id="notifications-enabled" checked>
                </div>
                <div class="setting-item">
                    <label>Sabah HatÄ±rlatma</label>
                    <input type="time" id="morning-reminder" value="08:00">
                </div>
                <div class="setting-item">
                    <label>AkÅŸam HatÄ±rlatma</label>
                    <input type="time" id="evening-reminder" value="20:00">
                </div>
            </div>
        </div>

        <div class="profile-actions">
            <button class="btn-secondary" onclick="exportData()">Verileri DÄ±ÅŸa Aktar</button>
            <button class="btn-danger" onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
        </div>

        <div class="bottom-nav">
            <button class="nav-btn" onclick="showScreen('dashboard-screen')">
                <span>ğŸ </span>
                <span>Ana Sayfa</span>
            </button>
            <button class="nav-btn" onclick="showScreen('timer-screen')">
                <span>â°</span>
                <span>Timer</span>
            </button>
            <button class="nav-btn" onclick="showScreen('stats-screen')">
                <span>ğŸ“Š</span>
                <span>Ä°statistik</span>
            </button>
            <button class="nav-btn active" onclick="showScreen('profile-screen')">
                <span>ğŸ‘¤</span>
                <span>Profil</span>
            </button>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="api.js"></script>
    <script src="timer.js"></script>
    <script src="sync.js"></script>
    <script src="app.js"></script>
    
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
